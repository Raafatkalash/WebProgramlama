using System.Linq;
using System.Threading.Tasks;
using FitnessCenterApp.Data;
using Microsoft.AspNetCore.Authorization;
using Microsoft.AspNetCore.Mvc;
using Microsoft.AspNetCore.Mvc.Rendering;
using Microsoft.EntityFrameworkCore;

namespace FitnessCenterApp.Controllers
{
    [Authorize(Roles = "Admin")]
    public class RaporlamaController : Controller
    {
        private readonly ApplicationDbContext _context;

        public RaporlamaController(ApplicationDbContext context)
        {
            _context = context;
        }

        public async Task<IActionResult> Index()
        {
            // Dropdown: üyeler (مع Id ليكون واضح للأستاذ)
            var uyeler = await _context.Uyeler
                .AsNoTracking()
                .OrderBy(u => u.Ad)
                .Select(u => new SelectListItem
                {
                    Value = u.Id.ToString(),
                    Text = $"{u.AdSoyad} (Id={u.Id})"
                })
                .ToListAsync();

            ViewBag.Uyeler = uyeler;
            return View();
        }
    }
}
